{% extends "base.html" %}

{% block head %}
{{ super() }}
<link href="{{ url_for('static', filename='css/professionals.css') }}" rel="stylesheet">
{% endblock %}

{% block title %}Book Appointment - {{ professional.name }}{% endblock %}

{% block content %}
<div class="professionals-page booking-page">
  <div class="professionals-header">
    <div class="container">
      <div class="breadcrumbs">
        <a href="{{ url_for('professional_bp.professionals_home') }}">Professional Help</a> &gt;
        {% if professional.profession == 'Psychologist' %}
          <a href="{{ url_for('professional_bp.psychologists') }}">Psychologists</a>
        {% elif professional.profession == 'Psychiatrist' %}
          <a href="{{ url_for('professional_bp.psychiatrists') }}">Psychiatrists</a>
        {% else %}
          <a href="{{ url_for('professional_bp.counselors') }}">Counselors</a>
        {% endif %}
        &gt;
        <a href="{{ url_for('professional_bp.professional_detail', professional_id=professional.id) }}">{{ professional.name }}</a> &gt;
        <span>Book Appointment</span>
      </div>
      <h1 class="page-title">Book an Appointment</h1>
      <p class="subtitle">Schedule a session with {{ professional.name }}</p>
    </div>
  </div>

  <div class="container">
    <div class="booking-container" data-aos="fade-up">
      <div class="booking-professional-info">
        <div class="profile-avatar medium">
          {{ professional.name[0] }}{{ professional.name.split()[-1][0] }}
        </div>
        <div class="professional-summary">
          <h2>{{ professional.name }}</h2>
          <p>{{ professional.credentials }}</p>
          <div class="specialties-list">
            {% for specialty in professional.specialties.split(',')[:3] %}
              <span class="specialty-tag">{{ specialty.strip() }}</span>
            {% endfor %}
          </div>
        </div>
      </div>
      
      <div class="booking-form-container">
        <form id="booking-form" action="{{ url_for('professional_bp.book_appointment', professional_id=professional.id) }}" method="post">
          <div class="form-section">
            <h3><i class="fas fa-calendar-alt"></i> Select Date & Time</h3>
            
            <div class="calendar-container">
              <div class="calendar-header">
                <button type="button" id="prev-month" class="calendar-nav"><i class="fas fa-chevron-left"></i></button>
                <h4 id="current-month">November 2023</h4>
                <button type="button" id="next-month" class="calendar-nav"><i class="fas fa-chevron-right"></i></button>
              </div>
              <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar will be generated by JavaScript -->
              </div>
            </div>
            
            <div class="time-selector">
              <h4>Available Times</h4>
              <div class="time-slots" id="time-slots">
                <p class="select-date-message">Please select a date to see available times</p>
                <!-- Time slots will be populated by JavaScript -->
              </div>
            </div>
            
            <input type="hidden" id="selected-date" name="selected-date">
            <input type="hidden" id="selected-time" name="selected-time">
          </div>
          
          <div class="form-section">
            <h3><i class="fas fa-comment-alt"></i> Session Information</h3>
            
            <div class="form-group">
              <label for="session-type">Session Type</label>
              <select id="session-type" name="session-type" required>
                <option value="initial">Initial Consultation (50 min)</option>
                <option value="regular">Regular Session (50 min)</option>
                <option value="follow-up">Brief Follow-up (25 min)</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="communication-preference">Communication Preference</label>
              <select id="communication-preference" name="communication-preference" required>
                <option value="video">Video Call</option>
                <option value="phone">Phone Call</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="session-reason">Reason for Visit</label>
              <textarea id="session-reason" name="session-reason" rows="3" placeholder="Briefly describe what you'd like to discuss in this session"></textarea>
            </div>
          </div>
          
          <div class="form-section">
            <h3><i class="fas fa-info-circle"></i> Important Information</h3>
            
            <div class="booking-info">
              <p>By booking this appointment, you agree to the following:</p>
              <ul>
                <li>A secure link to join your session will be sent to your email</li>
                <li>You need a private space with reliable internet connection</li>
                <li>Cancellations must be made at least 24 hours in advance</li>
                <li>All sessions are confidential and protected by privacy laws</li>
              </ul>
            </div>
            
            <div class="form-group">
              <label class="checkbox-container">
                <input type="checkbox" name="terms-agreement" required>
                <span class="checkmark"></span>
                I agree to the terms and conditions
              </label>
            </div>
          </div>
          
          <div class="form-actions">
            <a href="{{ url_for('professional_bp.professional_detail', professional_id=professional.id) }}" class="btn-secondary">
              Cancel
            </a>
            <button type="submit" class="gradient-button">
              Confirm Booking <i class="fas fa-check"></i>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="{{ url_for('static', filename='js/professionals/booking.js') }}"></script>
{% endblock %}